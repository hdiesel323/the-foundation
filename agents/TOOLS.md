# OpenClaw v2 — Available Tools by Memory Tier

This document lists all MCP tools and resources available to agents, organized by memory tier.
Every agent loads this file at startup (L1 context).

---

## L1 — Hot Context (Always Loaded)

Files loaded into every agent's context window at session start:

| File | Purpose |
|------|---------|
| `SOUL.md` | Agent personality, role, boundaries |
| `MEMORY.md` | Per-agent memory context and state |
| `AGENTS.md` | System-wide instructions, fleet overview |
| `TOOLS.md` | This file — available tools per tier |
| `SAFETY.md` | Safety rules, protected paths, VETO triggers |

These files are read-only context. No tool calls required.

---

## L2 — Warm Memory (Query on Demand)

### GraphMem — Knowledge Graph

| Tool | Description |
|------|-------------|
| `graphmem://entities/{query}` | Search entities (agents, divisions, components, decisions) |
| `graphmem://relationships/{entity_id}` | Get relationships for an entity (BELONGS_TO, LED_BY, OWNS, APPLIES_TO) |

Entities have temporal validity and Ebbinghaus forgetting curves. Relationships scored via PageRank.
Entity extraction: Gemini Flash. Vectors: text-embedding-3-small. Storage: PostgreSQL.

### QMD — Local Hybrid Search

| Tool | Description | Parameters |
|------|-------------|------------|
| `qmd_query` | Hybrid search (BM25 + vector) across QMD collections | `query`, `collection`, `limit`, `mode` (hybrid/keyword/semantic) |
| `qmd_fetch` | Fetch a specific document by path or ID | `path`, `collection` |

Collections: `agent-workspaces`, `shared-memory`, `documentation`.
Pipeline: BM25 keyword -> vector similarity -> LLM reranking.
Local models: embedding-gemma-300M, qwen3-reranker-0.6b, qmd-query-expansion-1.7B.

### Memory MCP — Session & Fact Store

| Tool | Description |
|------|-------------|
| `memory_store` | Store a preference, fact, or context entry |
| `memory_retrieve` | Query memories by type/category |
| `memory_search` | Search across memories (keyword + semantic) |
| `memory_delete` | Remove a specific memory entry |
| `memory_list` | List memories by category |

Resources:
- `memory://preferences` — All user preferences
- `memory://context/current` — Current conversation context
- `memory://facts/{category}` — Facts by category

---

## L3 — Business Intelligence (PostgreSQL)

Structured data queried via the Memory Bank MCP server. All 12 business tables accessible.

| Tool | Description |
|------|-------------|
| `biz_query` | Query business knowledge: leads, deals, revenue, campaigns |
| `biz_store` | Store business data: facts, preferences, insights |
| `biz_search` | Full-text search across all business tables |
| `biz_aggregate` | Aggregate metrics: revenue by vertical, pipeline by stage |

### Commerce MCP Tools

| Tool | Server | Description |
|------|--------|-------------|
| `alpaca_positions` | alpaca | Get current portfolio positions |
| `alpaca_orders` | alpaca | Place, list, or cancel orders |
| `alpaca_portfolio` | alpaca | Get portfolio value, buying power, and P&L |
| `alpaca_market_data` | alpaca | Get quotes, bars, and market snapshots |
| `retreaver_calls` | retreaver | Query call tracking data and call logs |
| `retreaver_campaigns` | retreaver | Manage campaigns and routing numbers |
| `retreaver_buyers` | retreaver | Manage buyer accounts and bid settings |
| `retreaver_revenue` | retreaver | Revenue attribution and performance metrics |
| `shopify_products` | shopify | CRUD operations on products |
| `shopify_orders` | shopify | Order management: list, fulfill, cancel, refund |
| `shopify_inventory` | shopify | Inventory tracking: levels, adjustments, locations |
| `shopify_analytics` | shopify | Store analytics: sales, traffic, conversion rates |
| `airtable_read` | airtable | Read records from Airtable bases and tables |
| `airtable_write` | airtable | Create and update records in Airtable |
| `airtable_search` | airtable | Search and filter records with formulas |

### External Integration Tools

| Tool | Server | Description |
|------|--------|-------------|
| `filesystem` | filesystem | Read/write files in /data |
| `calendar` | calendar | Google Calendar read/write |
| `slack` | slack | Post messages, read channels |
| `brave-search` | brave-search | Web search via Brave API |

---

## L4 — Archive (Cloud Sync)

Cold storage for historical data. R2 backup with 30-day retention.

| Tool | Path | Description |
|------|------|-------------|
| `backup.sh` | `scripts/backup.sh` | Full PostgreSQL backup to R2 (encrypted .sql.gz.gpg) |
| `restore.sh` | `scripts/restore.sh` | Restore from R2 backup on demand |

Triggered manually or via scheduled patrol. Not called during normal agent operation.

---

## L5 — Code (Cartographer)

Codebase structure mapping generated by the Cartographer patrol.

| Resource | Path | Description |
|----------|------|-------------|
| `CODEBASE_MAP.md` | `docs/CODEBASE_MAP.md` | Directory tree, file counts, agent/config/script listings, dependency graph |
| `cartographer.sh` | `scripts/cartographer.sh` | Regenerate codebase map on demand |

Auto-updated every 24h via `config/patrol-cartographer.yml`. Auto-commits if changes detected.

---

## Tool Access by Division

Not all agents need all tools. Recommended access per division:

| Division | L2 Tools | L3 Tools | Notes |
|----------|----------|----------|-------|
| Command (seldon) | All L2 | All L3 | Orchestrator — full access |
| Infrastructure (daneel, hardin) | graphmem, memory | biz_query | Read-only biz; hardin has VETO |
| Commerce (mallow, preem, riose, trader) | memory, qmd | biz_*, alpaca, retreaver, shopify, airtable | Full commerce stack |
| Intelligence (gaal, demerzel, mis, amaryl) | graphmem, qmd, memory | biz_query, biz_aggregate | Read-only; gaal has VETO |
| Operations (magnifico, venabili, arkady) | memory, qmd | biz_query, slack, calendar | Interface + project mgmt |
