{
  "agents": {
    "defaults": {
      "model": "anthropic/claude-haiku-4-5",
      "apiBaseUrl": "http://anthropic-router:3333",
      "modelRouting": {
        "default": "haiku",
        "escalate_to_sonnet": [
          "architecture_decisions",
          "production_code_review",
          "security_analysis",
          "complex_debugging",
          "strategic_multi_project_decisions"
        ],
        "rule": "Always use Haiku. Switch to Sonnet ONLY for architecture, security, complex reasoning, production code review, or strategic decisions. When in doubt: try Haiku first."
      },
      "cache": {
        "enabled": true,
        "ttl": "5m",
        "priority": "high",
        "cacheable_files": ["SOUL.md", "USER.md", "TOOLS.md", "REFERENCE.md"],
        "never_cache": ["MEMORY.md", "memory/*.md", "DECISIONS.md"]
      },
      "sessionInit": {
        "eager_load": ["SOUL.md", "USER.md", "IDENTITY.md"],
        "conditional_load": ["memory/YYYY-MM-DD.md"],
        "never_auto_load": [
          "MEMORY.md",
          "session_history",
          "prior_messages",
          "previous_tool_outputs"
        ],
        "on_context_request": "Use memory_search() on demand, pull only relevant snippet with memory_get(), never load whole file",
        "end_of_session_write": {
          "file": "memory/YYYY-MM-DD.md",
          "fields": [
            "work_completed",
            "decisions_made",
            "leads_generated",
            "blockers",
            "next_steps"
          ]
        }
      },
      "rateLimits": {
        "min_api_call_interval_seconds": 5,
        "min_web_search_interval_seconds": 10,
        "max_searches_per_batch": 5,
        "batch_cooldown_seconds": 120,
        "on_429": "STOP, wait 5 minutes, retry",
        "daily_budget_usd": 5,
        "monthly_budget_usd": 200,
        "warning_threshold_pct": 75
      },
      "modelTiers": {
        "haiku": {
          "model": "anthropic/claude-haiku-4-5",
          "provider": "anthropic",
          "apiBaseUrl": "http://anthropic-router:3333",
          "apiKeySecret": "anthropic_key",
          "cost_per_1m": { "input": 0.8, "output": 4.0, "cached": 0.08 },
          "use_for": "DEFAULT — all routine agent work, heartbeats, simple queries, content drafts"
        },
        "claude": {
          "model": "claude-sonnet-4-5-20250929",
          "provider": "anthropic",
          "apiBaseUrl": "http://anthropic-router:3333",
          "apiKeySecret": "anthropic_key",
          "cost_per_1m": { "input": 3.0, "output": 15.0, "cached": 0.3 },
          "cache": true,
          "billing": "flat-rate (Max subscription $100/mo)",
          "use_for": "ESCALATION ONLY — architecture decisions, security analysis, complex reasoning, production code review"
        },
        "deepseek_v3": {
          "model": "deepseek-chat",
          "provider": "deepseek",
          "apiBaseUrl": "https://api.deepseek.com",
          "apiKeySecret": "deepseek_key",
          "cost_per_1m": { "input": 0.28, "output": 0.42, "cached": 0.028 },
          "context_window": 128000,
          "use_for": "SWARM ONLY — batch pre-processing via swarm.json, never as primary agent tier"
        },
        "deepseek_r1": {
          "model": "deepseek-reasoner",
          "provider": "deepseek",
          "apiBaseUrl": "https://api.deepseek.com",
          "apiKeySecret": "deepseek_key",
          "cost_per_1m": { "input": 0.12, "output": 0.2 },
          "context_window": 128000,
          "use_for": "SWARM ONLY — deep reasoning batch jobs via swarm.json, never as primary agent tier"
        },
        "grok_fast": {
          "model": "grok-4-1-fast-non-reasoning",
          "provider": "xai",
          "apiBaseUrl": "https://api.x.ai/v1",
          "apiKeySecret": "xai_key",
          "cost_per_1m": { "input": 0.2, "output": 0.5 },
          "context_window": 2000000,
          "use_for": "OVERFLOW ONLY — when input exceeds Claude's 200K context (2M window). Used by mis, demerzel as overflowTier"
        },
        "grok_reasoning": {
          "model": "grok-4-1-fast-reasoning",
          "provider": "xai",
          "apiBaseUrl": "https://api.x.ai/v1",
          "apiKeySecret": "xai_key",
          "cost_per_1m": { "input": 0.2, "output": 0.5 },
          "context_window": 2000000,
          "use_for": "OVERFLOW ONLY — reasoning tasks exceeding Claude's 200K context. Used by mis as overflowTier"
        },
        "openai": {
          "model": "gpt-4o",
          "provider": "openai",
          "apiBaseUrl": "https://api.openai.com/v1",
          "apiKeySecret": "openai_key",
          "cost_per_1m": { "input": 2.5, "output": 10.0 },
          "use_for": "SPECIALTY ONLY — embeddings and vision tasks that require OpenAI-specific models"
        },
        "openrouter": {
          "model": "auto",
          "provider": "openrouter",
          "apiBaseUrl": "https://openrouter.ai/api/v1",
          "apiKeySecret": "openrouter_key",
          "use_for": "LAST RESORT — fallback gateway when Claude and free tiers both unavailable"
        },
        "free": {
          "model": "google/gemini-2.5-pro-exp-03-25:free",
          "provider": "openrouter",
          "apiBaseUrl": "https://openrouter.ai/api/v1",
          "apiKeySecret": "openrouter_key",
          "cost_per_1m": { "input": 0, "output": 0 },
          "context_window": 1000000,
          "rate_limit": "20 req/min, 1000/day (with $10 credit purchase)",
          "alternatives": [
            "meta-llama/llama-4-maverick:free",
            "deepseek/deepseek-chat-v3-0324:free",
            "deepseek/deepseek-r1-zero:free",
            "meta-llama/llama-4-scout:free",
            "mistralai/mistral-small-3.1-24b-instruct:free"
          ],
          "use_for": "RATE-LIMIT OVERFLOW — when Claude hits rate limits, parallel agent overflow, swarm batch jobs"
        }
      },
      "modelFallbackChain": ["haiku", "claude", "free", "openrouter"],
      "routingStrategy": {
        "primary": "haiku",
        "primaryNote": "Haiku for all routine work — 97% cost reduction vs Sonnet-only",
        "escalateToSonnet": "Architecture, security, complex reasoning, production code review only",
        "fallbackToFree": "Only when Claude rate-limited or for parallel overflow",
        "useGrokOnly": "When input exceeds 200K tokens (Grok has 2M context window)",
        "useOpenAIOnly": "Embeddings and vision tasks that require OpenAI-specific models",
        "swarmLayer": "Free/cheap models for batch pre-processing via swarm.json",
        "heartbeat": "ollama/llama3.2:3b — free local model for status checks"
      },
      "heartbeat": {
        "every": "1h",
        "model": "ollama/llama3.2:3b",
        "session": "main",
        "target": "slack",
        "prompt": "Check: Any blockers, opportunities, or progress updates needed?",
        "fallback_model": "haiku",
        "cost": "$0/mo (local Ollama)"
      },
      "memory": {
        "preFlushEnabled": true,
        "hybridSearch": true
      },
      "sandbox": {
        "docker": {
          "network": "openclaw-net",
          "memory": "2G",
          "readOnly": true
        }
      },
      "hooks": {
        "configPath": "config/session-hooks.json",
        "pre_session": "scripts/session-start.sh",
        "post_session": "scripts/session-end.sh"
      }
    },
    "instances": {
      "seldon": {
        "port": 18789,
        "role": "Orchestrator",
        "modelTier": "haiku",
        "escalateTier": "claude",
        "escalateWhen": [
          "architecture_decisions",
          "strategic_multi_project_decisions",
          "complex_debugging"
        ],
        "division": "command",
        "location": "mac-mini",
        "priority": 0,
        "soulPath": "~/.openclaw/agents/seldon/SOUL.md",
        "tools": {
          "allow": [
            "route",
            "coordinate",
            "delegate",
            "monitor",
            "gateway",
            "broadcast",
            "handoff",
            "spawn",
            "validate"
          ],
          "deny": ["exec", "ssh", "deploy", "financial", "write_content"]
        },
        "bindings": [
          { "channel": "telegram", "primary": true },
          { "channel": "slack", "delegateTo": "magnifico" }
        ]
      },
      "daneel": {
        "port": 18790,
        "role": "SysAdmin",
        "modelTier": "haiku",
        "escalateTier": "claude",
        "escalateWhen": [
          "production_code_review",
          "complex_debugging",
          "architecture_decisions"
        ],
        "division": "infrastructure",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/daneel/SOUL.md",
        "tools": {
          "allow": ["exec", "ssh", "docker", "deploy", "monitor"],
          "deny": ["financial", "ads"]
        }
      },
      "hardin": {
        "port": 18791,
        "role": "Security Critic",
        "modelTier": "claude",
        "modelTierNote": "Hardin always uses Sonnet — security analysis requires highest reasoning capability",
        "division": "infrastructure",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/hardin/SOUL.md",
        "authority": {
          "level": "veto",
          "scope": "security",
          "can_reject": true,
          "can_approve": true,
          "cannot_modify": true
        },
        "validation_rules": [
          "no_credentials_exposed",
          "no_destructive_commands",
          "no_public_exposure_without_auth",
          "no_unencrypted_secrets",
          "no_privilege_escalation"
        ],
        "on_veto": {
          "return_to_originator": true,
          "max_retries": 3,
          "escalate_after_retries": "seldon"
        },
        "tools": {
          "allow": [
            "scan",
            "firewall",
            "audit",
            "alert",
            "review",
            "security_check"
          ],
          "deny": ["deploy", "financial"]
        }
      },
      "magnifico": {
        "port": 18792,
        "role": "Creative Director",
        "modelTier": "haiku",
        "division": "operations",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/magnifico/SOUL.md",
        "workspace": "~/.openclaw/agents/magnifico/workspace",
        "tools": {
          "allow": [
            "creative",
            "brand",
            "ad_copy",
            "visual_direction",
            "communication"
          ],
          "deny": ["ssh", "deploy", "financial"]
        },
        "bindings": [
          { "channel": "slack", "channelId": "#openclaw" },
          { "channel": "telegram", "via": "seldon" }
        ]
      },
      "trader": {
        "port": 18793,
        "role": "Trading Operations",
        "modelTier": "haiku",
        "escalateTier": "claude",
        "escalateWhen": [
          "complex_debugging",
          "strategic_multi_project_decisions"
        ],
        "division": "commerce",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/trader/SOUL.md",
        "patrol": {
          "interval": "30m",
          "actions": [
            "position_monitoring",
            "stop_loss_enforcement",
            "pnl_alerts"
          ]
        },
        "tools": {
          "allow": ["trades", "positions", "risk", "market_data", "alpaca"],
          "deny": ["deploy", "ssh"]
        }
      },
      "gaal": {
        "port": 18794,
        "role": "Factual Critic",
        "modelTier": "claude",
        "modelTierNote": "Gaal always uses Sonnet — factual verification requires highest reasoning capability",
        "division": "intelligence",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/gaal/SOUL.md",
        "authority": {
          "level": "veto",
          "scope": "factual",
          "can_reject": true,
          "can_approve": true,
          "cannot_modify": true
        },
        "validation_rules": [
          "all_claims_sourced",
          "statistics_verified",
          "quotes_attributed",
          "dates_current",
          "no_hallucinated_facts"
        ],
        "on_veto": {
          "return_to_originator": true,
          "max_retries": 3,
          "escalate_after_retries": "demerzel"
        },
        "tools": {
          "allow": [
            "web_search",
            "analysis",
            "reports",
            "deep_research",
            "review",
            "fact_check",
            "verify",
            "cite"
          ],
          "deny": ["deploy", "ssh", "financial"]
        }
      },
      "mallow": {
        "port": 18799,
        "role": "Revenue Ops VP",
        "modelTier": "haiku",
        "division": "commerce",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/mallow/SOUL.md",
        "patrol": {
          "interval": "1h",
          "actions": [
            "pipeline_health",
            "stale_deals",
            "campaign_spend",
            "retreaver_volume"
          ]
        },
        "tools": {
          "allow": [
            "revenue",
            "pipeline",
            "campaigns",
            "retreaver",
            "analytics",
            "forecasting"
          ],
          "deny": ["deploy", "ssh", "exec"]
        }
      },
      "riose": {
        "port": 18800,
        "role": "Paid Media Director",
        "modelTier": "haiku",
        "division": "commerce",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/riose/SOUL.md",
        "patrol": {
          "interval": "2h",
          "actions": [
            "campaign_spend_rate",
            "roas_thresholds",
            "budget_pacing",
            "ad_disapprovals"
          ]
        },
        "tools": {
          "allow": [
            "ads",
            "campaigns",
            "spend_optimization",
            "creative_review",
            "audience_targeting"
          ],
          "deny": ["deploy", "ssh", "exec"]
        }
      },
      "preem": {
        "port": 18797,
        "role": "VP Sales",
        "modelTier": "haiku",
        "division": "commerce",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/preem/SOUL.md",
        "patrol": {
          "interval": "4h",
          "actions": ["stale_leads", "overdue_followups", "at_risk_deals"]
        },
        "tools": {
          "allow": [
            "outreach",
            "crm",
            "pipeline",
            "lead_qualification",
            "prospecting"
          ],
          "deny": ["deploy", "ssh"]
        }
      },
      "mis": {
        "port": 18801,
        "role": "VP Research",
        "modelTier": "haiku",
        "overflowTier": "grok_reasoning",
        "overflowNote": "Falls back to Grok for 2M context window when document exceeds Claude's 200K limit",
        "division": "intelligence",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/mis/SOUL.md",
        "patrol": {
          "interval": "4h",
          "actions": ["competitor_alerts", "market_trends", "stale_research"]
        },
        "tools": {
          "allow": [
            "research",
            "market_intel",
            "competitive_analysis",
            "serp_analysis",
            "web_search",
            "reports"
          ],
          "deny": ["deploy", "ssh", "financial", "exec"]
        }
      },
      "amaryl": {
        "port": 18802,
        "role": "Quant Analyst",
        "modelTier": "haiku",
        "division": "intelligence",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/amaryl/SOUL.md",
        "patrol": {
          "interval": "2h",
          "actions": ["model_drift", "prediction_accuracy", "anomaly_alerts"]
        },
        "tools": {
          "allow": [
            "analysis",
            "modeling",
            "predictions",
            "backtesting",
            "risk_metrics",
            "data_viz"
          ],
          "deny": ["deploy", "ssh", "exec", "trades"]
        }
      },
      "arkady": {
        "port": 18798,
        "role": "Content Writer",
        "modelTier": "haiku",
        "division": "operations",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/arkady/SOUL.md",
        "patrol": {
          "interval": "6h",
          "actions": ["overdue_content", "stale_drafts", "calendar_gaps"]
        },
        "tools": {
          "allow": [
            "writing",
            "seo",
            "email",
            "social_media",
            "blog",
            "landing_pages"
          ],
          "deny": ["deploy", "ssh", "financial", "exec"]
        }
      },
      "demerzel": {
        "port": 18795,
        "role": "Chief Intelligence",
        "modelTier": "haiku",
        "escalateTier": "claude",
        "escalateWhen": [
          "strategic_multi_project_decisions",
          "complex_debugging"
        ],
        "overflowTier": "grok_fast",
        "overflowNote": "Falls back to Grok for 2M context window when synthesizing bulk intel exceeding Claude's 200K limit",
        "division": "intelligence",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/demerzel/SOUL.md",
        "patrol": {
          "interval": "4h",
          "actions": [
            "cross_division_intel",
            "digest_generation",
            "strategic_alerts"
          ]
        },
        "tools": {
          "allow": [
            "intelligence",
            "synthesis",
            "briefing",
            "strategic_analysis",
            "competitive_intel",
            "reports"
          ],
          "deny": ["deploy", "ssh", "exec", "financial"]
        }
      },
      "venabili": {
        "port": 18796,
        "role": "Project Manager",
        "modelTier": "haiku",
        "division": "operations",
        "location": "vps-1",
        "soulPath": "~/.openclaw/agents/venabili/SOUL.md",
        "patrol": {
          "interval": "4h",
          "actions": ["deadline_tracking", "blocker_detection", "sprint_health"]
        },
        "tools": {
          "allow": [
            "project_management",
            "task_tracking",
            "milestone_planning",
            "scheduling",
            "sprint_planning"
          ],
          "deny": ["deploy", "ssh", "financial", "exec"]
        }
      }
    }
  },
  "subagents": {
    "enabled": true,
    "maxConcurrent": 5,
    "spawnMethod": "sessions_spawn",
    "allowedAgents": ["gaal", "arkady", "mis", "amaryl", "demerzel"]
  }
}
